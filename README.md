# Building

## changes needed

- structure
  - so many `warning: extra qualification` warnings... i was trying to make it obvious what was specifically exposed in the library, causes a huge warning dump
  - remove hardcoded path to parent repo libraries
  - add necessary included libraries
  - handle anything with `TODO: Forced game includes`
    - `ui_api_events` -> `patches/ui_funcs.h`
    - `ui_renderer` -> headers for InterfaceVS/InterfacePS
- assets
  - need to provide default assets with ability to override
- `recompui`
  - `include/recompui/recompui.h`
    - audit exposed funcs, potentially only include functions a base project might need? then the rest could go somewhere else
  - `ui_element`
    - new nav system could go somewhere else (currently at the bottom of `ui_element.c`)
  - `renderer`
    - remove hardcoded
  - `ui_config`
    - higher level (e.g. safe) way of queuing the config modal opening in general.
  - `ui_modal`
    - split to `TabbedModal`
    - `MenuAction` events
      - ability to show controls hints
        - Tricky part: `MenuAction::Apply` handled elsewhere. maybe need special way of adding ctrl hints to root doc?
  - `ui_state`
    - should have base rcss for setting rcss ONLY globals
      - audit input.radio 0 width
      - scrollbar settings configurable
    - too much input handling?
      - `check_menu_button_pressed` identity crisis. makes more sense in `profiles.cpp`, can just be `check_mapped_game_input_press` or something similar
      - `cont_button_to_key`
      - `cont_axis_to_key`
      - `draw_hook` is a lot.
      - controller button repeats (should only be direction nav anyways)
    - bit of a dumping ground of helper/exposed funcs that could be better categorized
  - `ui_prompt`
    - takes `return_element_id`, instead should store current focused element?
  - `ui_assign_players_modal`
    - should probably open and instantiate in a more integrated way. has risk of not being in a valid context
    - UI adjustments (title + padding)
    - expose mod/patch c API for opening
  - `ui_config_page`
    - Needs WAY better naming. It is just a commonly reused layout of header/body/footer where you can assign elements to the left and right
  - `ui_config_page_controls`
    - Needs to use `game_input_contexts` descriptions on row hover
    - Needs to hide (or disable?) menu controls for keyboard
    - Should check `recompinput::players::is_single_player_mode()` if single player mode is active
  - `ui_config_tab_controls`
    - `create_controls_tab` hardcodes descriptions when adding the available GameInput inputs, and also determines whether or not an input should be able to be cleared, and doesn't specify if its only changeable on controller (see `input_types`)
  - `ui_select`
    - i think i forgor to add indication of which element in the dropdown is the current
    - need to test for new navigation system conflicts
  - `ui_tab_set`
    - cursor set to pointer
- `recompinput`
  - `input_types`
    - should be able to customize `game_input_names`
    - should have `descriptions` for `ui_config_tab_controls` (expose for customization)
    - should be able to designate which `GameInput`s can't be changed on keyboard
    - should be able to designate which `GameInput`s can't be cleared on controller
    - should be able to add new non n64 inputs
  - `input_mapping`
    - `default_n64_mappings_controller` and `default_n64_mappings_keyboard` should have helpers for overridding
  - `input_state`
    - ~~`controller_states` seems like it could have a better link with `profiles`' `controllers` vector. both are used for tracking which controllers are plugged/unplugged so a global controller registry would be a good simplification I think.~~ edit: these states are more reflective of what is currently connected while `profiles` is maintaining a registry of what was ever connected which is very important for player reconnection
    - whole file feels off to me, like its trying to do too much or that some stuff could be separated
  - `input_events`
    - toggle menu's binding cancel only considers inputs from profile "0". should be the specific controller's player's profile (or single player mode check)
    - a lot of binding handling in general. could be moved to a function in `input_binding.cpp`? would need to be able to report if it is stealing inputs. `input_events` handles controller connection as well, so maybe there should be a smarter way to hook anything up to `sdl_event_filter`, like a vector of callbacks
  - `players`
    - `single_player_mode` should be separate from max players
    - concept of players and profiles are disjointed, maybe thats okay? controller reconnects should attempt to preserve the last player's profile

## before public wishlist

- New config types
  - Enum sub-variant: dropdown
  - Color picker
    - important cus a lot of people are using hex which means it doesn't have controller support
- Mod recompui: expose functionality
  - new nav system (very important)
    - Document api usage.
    - `set_as_navigation_container` w/ enum for `NavigationType`s
    - `set_as_primary_focus`
    - `set_nav_wrapping`?
  - new button styles `ButtonStyle` + `ButtonSize`
  - new components
    - `IconButton`
    - `Select`
    - `Modal`
      - `TabbedModal` maybe?
      - open/close functions
      - expose `Modal::create_modal`
      - expose getting `Modal::modal_root_context`
    - `PillButton` (not very important)
  - expose Typography enum
  - expose more Style methods
    - `Style::set_typography`
    - TODO: list methods to expose
